#!/bin/bash

BINARY_LOCATION=/u/project/puneet/mgottsch/eccgrp-ecc-ctrl
ISA=rv64g
N=72
K=64
ORIGINAL_MESSAGE=$1
#ERROR_PATTERN=1100 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000
ERROR_PATTERN=110000000000000000000000000000000000000000000000000000000000000000000000
CODE_TYPE=hsiao1970
POLICY=delta
TIEBREAK_POLICY=pick_first
CACHELINE=\{\'${ORIGINAL_MESSAGE}\',\'${ORIGINAL_MESSAGE}\',\'${ORIGINAL_MESSAGE}\',\'${ORIGINAL_MESSAGE}\',\'${ORIGINAL_MESSAGE}\',\'${ORIGINAL_MESSAGE}\',\'${ORIGINAL_MESSAGE}\',\'${ORIGINAL_MESSAGE}\'\}
MESSAGE_BLOCKPOS=0
VERBOSE=1

# Library paths are for running on Hoffman2
LD_PRELOAD=$GCC5/lib64/libstdc++.so.6 LD_LIBRARY_PATH=$MATLAB/bin/glnxa64:$MATLAB/runtime/glnxa64:$LD_LIBRARY_PATH $BINARY_LOCATION/data_recovery $ISA $N $K $ORIGINAL_MESSAGE $ERROR_PATTERN $CODE_TYPE $POLICY $TIEBREAK_POLICY $CACHELINE $MESSAGE_BLOCKPOS $VERBOSE
